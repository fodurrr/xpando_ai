# Story 1.1: Project Bootstrap & Ash Setup

## Status
Draft

## Story
**As a** development team,
**I want** a properly configured Phoenix umbrella application with Ash framework integration,
**so that** we have a solid foundation for building all xPando features with proper separation of concerns.

## Acceptance Criteria
1. Phoenix umbrella application created with proper app separation (xpando_core, xpando_web)
2. Ash 3.5.36 framework integrated with ash_postgres 2.6.16, ash_authentication 4.9.9 dependencies
3. PostgreSQL database configured with connection pooling
4. DevBox shell configuration working for all developers
5. Basic CI/CD pipeline with GitHub Actions
6. Project compiles without warnings

## Tasks / Subtasks
- [ ] Initialize Phoenix umbrella project (AC: 1)
  - [ ] Run `mix phx.new xpando --umbrella --install`
  - [ ] Verify apps structure created: xpando_core and xpando_web
  - [ ] Configure umbrella mix.exs with proper project metadata
- [ ] Set up DevBox shell environment (AC: 4)
  - [ ] Create devbox.json with Elixir 1.18.1, PostgreSQL 16+, Node.js
  - [ ] Add devbox.lock for reproducible environments
  - [ ] Test shell activation with `devbox shell`
- [ ] Configure Ash framework dependencies (AC: 2)
  - [ ] Add Ash 3.5.36 dependencies to xpando_core/mix.exs
  - [ ] Add ash_postgres 2.6.16, ash_authentication 4.9.9
  - [ ] Configure Ash in xpando_core application supervisor
  - [ ] Create XPando.Registry module for resource registration
- [ ] Set up PostgreSQL database (AC: 3)
  - [ ] Configure Ecto repo in xpando_core: XPando.Repo
  - [ ] Add database configuration to config/dev.exs and config/test.exs
  - [ ] Set connection pool size to 10 in config
  - [ ] Run `mix ecto.create` to verify database connectivity
- [ ] Configure Phoenix web application (AC: 1, 6)
  - [ ] Set up xpando_web to depend on xpando_core
  - [ ] Configure Phoenix endpoint and router
  - [ ] Add Tailwind CSS and DaisyUI 4.12.14 to assets
  - [ ] Configure ESBuild 0.10.0 for asset compilation
- [ ] Create GitHub Actions CI pipeline (AC: 5)
  - [ ] Create .github/workflows/ci.yaml
  - [ ] Add steps: checkout, setup elixir, deps, compile, test
  - [ ] Configure PostgreSQL service container for tests
  - [ ] Add mix format --check-formatted step
- [ ] Clean compilation and initial test (AC: 6)
  - [ ] Run `mix deps.get` in umbrella root
  - [ ] Run `mix compile --warnings-as-errors`
  - [ ] Fix any compilation warnings
  - [ ] Create basic smoke test in each app

## Dev Notes

### Project Structure
Based on [Source: architecture/unified-project-structure.md], the project should follow this structure:
```
xpando/
├── apps/
│   ├── xpando_core/           # Core domain logic with Ash Resources
│   │   ├── lib/xpando/
│   │   │   ├── core/          # Ash Resources location
│   │   │   │   ├── resources/
│   │   │   │   └── registry.ex
│   │   │   └── repo.ex        # Ecto Repo
│   └── xpando_web/            # Phoenix web interface
│       ├── lib/xpando_web/
│       │   ├── components/
│       │   ├── live/
│       │   ├── router.ex
│       │   └── endpoint.ex
```

### Key Technical Requirements
From [Source: architecture/tech-stack.md]:
- **Elixir Version:** 1.18.1
- **Phoenix Version:** 1.8.0
- **Ash Framework:** 3.5.36 with ash_postgres 2.6.16, ash_authentication 4.9.9
- **Database:** PostgreSQL 16+
- **Frontend:** Phoenix LiveView 1.1+ with DaisyUI 4.12.14 components
- **Build Tools:** Mix for Elixir, ESBuild 0.10.0 for assets, pnpm for package management

### Ash Configuration
From [Source: architecture/coding-standards.md#critical-fullstack-rules]:
- Always define domain logic in Ash Resources, never bypass for direct Ecto
- Never modify Ash-generated migrations directly, use Ash migrations
- Migration safety is critical - use Ash migration commands

### Database Configuration
The Ecto Repo should be created at `apps/xpando_core/lib/xpando/repo.ex` and configured to work with ash_postgres adapter.

### CI/CD Setup
GitHub Actions workflow should be created at `.github/workflows/ci.yaml` with PostgreSQL service container for running tests in CI environment.

### Testing
From [Source: architecture/testing-strategy.md]:
- Test files location: `apps/xpando_core/test/` and `apps/xpando_web/test/`
- Create DataCase and ConnCase in test support files
- Use ExUnit as the testing framework

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-28 | 1.0 | Initial story creation | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
(To be filled by Dev Agent)

### Debug Log References
(To be filled by Dev Agent)

### Completion Notes List
(To be filled by Dev Agent)

### File List
(To be filled by Dev Agent)

## QA Results
(To be filled by QA Agent)